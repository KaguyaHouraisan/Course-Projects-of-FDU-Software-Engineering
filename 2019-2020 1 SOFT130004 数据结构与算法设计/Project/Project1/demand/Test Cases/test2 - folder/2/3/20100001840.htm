<HTML>
<HEAD>
<STYLE TYPE="text/css">
	PRE { font-family: "Times New Roman"; font-size: 12pt; }
</STYLE>
<BASE TARGET="_top">
<TITLE>United States Patent Application: 0100001840</TITLE></HEAD>
<BODY BGCOLOR="#FFFFFF">
<a name="top"></a>
<!-BUF1=0100001840
BUF51=0
BUF2=20100001840
-->
<center>
<IMG SRC="/netaicon1/PTO/AppFThdr.gif">
</center>  
<center>
<!-- <IMG border=0 src=/netaicon1/PTO/titlebar.gif><br> -->
<A HREF="/netahtml/PTO/help/help.html"><IMG BORDER="0" WIDTH="63" HEIGHT="24"  align=middle SRC="/netaicon1/PTO/help.gif" ALT="[Help]"></A>
<a href="http://www.uspto.gov/patft/index.html"><img src="/netaicon1/PTO/home.gif" alt="[Home]" border="0" width="63" height="24" align=middle></a>
<a href="/netahtml/PTO/search-bool.html"><img src="/netaicon1/PTO/boolean.gif" alt="[Boolean Search]" border="0" width="63" height="24" align=middle></a>
<A HREF="/netahtml/PTO/search-adv.html"><IMG WIDTH="63" HEIGHT="24" BORDER="0" SRC="/netaicon1/PTO/manual.gif" ALT="[Manual]" align=middle></A>
<a href="/netahtml/PTO/srchnum.html"><img src="/netaicon1/PTO/number.gif" alt="[Number Search]" border="0" width="63" height="24" align=middle></a>
<A HREF="http://www.uspto.gov/go/ptdl/">
<IMG width=63 height=24 border=0 SRC="/netaicon1/PTO/ptdl.gif" ALT="[PTDLs]" align=middle></A>
</center>
<center><A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=9&p=1&f=S&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/hitlist.gif border=0 ALT=[CURR_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=9&p=2&f=S&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=8&p=1&f=G&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=10&p=1&f=G&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>
<a href="#bottom"><img src="/netaicon1/PTO/bottom.gif" align=middle border=0></A>
<br><A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//appft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%26r%3D9%26p%3D1%26f%3DG%26l%3D50%26d%3DPG01%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)&backLabel1=Back%20to%20Published%20Application%20Number%3A%2020100001840">
<img border=0 src="/netaicon1/PTO/cart.gif" border=0 alt="[Shopping Cart]"></A>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=US20100001840&backUrl1=http%3A//appft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%26r%3D9%26p%3D1%26f%3DG%26l%3D50%26d%3DPG01%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)&backLabel1=Back%20to%20Published%20Application%20Number%3A%2020100001840">
<img border=0 src="/netaicon1/PTO/order.gif" alt="[Order Copy]"></A>
</center>
<CENTER>
<a href=http://aiw1.uspto.gov:80/.aiw?Docid=20100001840&homeurl=http%3A%2F%2Fappft1.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%2526r%3D9%2526p%3D1%2526f%3DG%2526l%3D50%2526d%3DPG01%2526S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%2526OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)%2526RS%3D(ABST%2F(RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522)%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))&PageNum=&Rtype=&SectionNum=&idkey=AFDA59809C2C
><img src="/netaicon1/PTO/image.gif" alt="[Image]" border="0" width="63" height="24" align="middle"></A>
</CENTER>
<p>
<TABLE border=0>
<TR><TD VALIGN=TOP ALIGN=LEFT width=40>
&nbsp;
</TD>
<TD VALIGN=TOP ALIGN=LEFT width=40>
&nbsp;
</TD>
<TD VALIGN=TOP ALIGN=RIGHT WIDTH=50>
</TD><TD ALIGN=RIGHT VALIGN=BOTTOM WIDTH=500><FONT SIZE=-1>( <STRONG>9</STRONG></FONT> <FONT SIZE=-2>of</FONT> <STRONG><FONT SIZE=-1>65</STRONG> )</FONT></TD></TR></TABLE>
<HR>
<TABLE WIDTH="100%">
<TR>	<TD ALIGN="LEFT" WIDTH="50%"><B>United States Patent Application</B></TD>
	<TD ALIGN="RIGHT" WIDTH="50%"><B>20100001840
</B></TD>
</TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="50%"><B>Kind Code</B>
  </TD><TD ALIGN="RIGHT" WIDTH="50%">                    
  <B>A1
</B></TD></TR>
<TR><TD ALIGN="LEFT" WIDTH="50%"><b>
KANG; You Sung
; &nbsp et al.</B>
</TD><TD ALIGN="RIGHT" WIDTH="50%"> <B>
January 7, 2010
</B></TD>
</TR>
</TABLE><HR>
<font size="+1">METHOD AND SYSTEM FOR AUTHENTICATING RFID TAG
</font><BR>
<BR><CENTER><B>Abstract</B></CENTER>
<P>Provided are a method and a system for authenticating a <B><I>radio frequency
     identification (RFID</I></B>) tag, by which an <B><I>RFID</I></B> reader and an authentication
     server authenticate the <B><I>RFID</I></B> tag by using a cryptographic operation and a
     protocol.
</P>
<HR>
<TABLE WIDTH="100%">
<TR> <TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Inventors:</TD>
<TD ALIGN="LEFT" WIDTH="90%">
 <B>KANG; You Sung</B>; <I>(Daejeon-city, KR)</I>
<B>; CHOI; Yong Je</B>; <I>(Daejeon-city, KR)</I>
<B>; CHOI; Doo Ho</B>; <I>(Dongnam-gu, KR)</I>
<B>; CHUNG; Kyo Il</B>; <I>(Daejeon-city, KR)</I>
<B>; CHO; Hyun Sook</B>; <I>(Daejeon-city, KR)</I>

</TD>
</TR>  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Correspondence Address:
  </TD><TD ALIGN="LEFT" WIDTH="90%">
  <B><PRE>    BLAKELY SOKOLOFF TAYLOR & ZAFMAN LLP
    1279 OAKMEAD PARKWAY
    SUNNYVALE
    CA
    94085-4040
    US
</PRE></B>
  </TD></TR>
<TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%" NOWRAP>Serial No.:
</TD><TD ALIGN="LEFT" WIDTH="90%">                    
<B>498221</B></TD></TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Series Code:
  </TD><TD ALIGN="LEFT" WIDTH="90%">                    
  <B>12
</B></TD></TR>
  <TR><TD VALIGN="TOP" ALIGN="LEFT" WIDTH="10%">Filed:
  </TD><TD ALIGN="LEFT" WIDTH="90%">                    
  <B>July 6, 2009</B></TD></TR>
</TABLE>
<p>
<TABLE WIDTH="100%">
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Current U.S. Class:</B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="60%"><B>340/10.1</B>  </TD></TR>  
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>Class at Publication:</B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="60%"><B>340/10.1</B>  </TD></TR>
  <TR><TD VALIGN=TOP ALIGN="LEFT" WIDTH="40%"><B>International Class: </B></TD>
  <TD VALIGN=TOP ALIGN="RIGHT" WIDTH="60%">H04Q 5/22 20060101 H04Q005/22</TD></TR>
</TABLE>
<HR>
<CENTER><B><I>Foreign Application Data</I></B></CENTER>
<HR>

<TABLE WIDTH="100%">
<TR><TH ALIGN="CENTER">Date</TH><TH ALIGN="CENTER">Code</TH><TH ALIGN="CENTER">Application Number</TH></TR>
<TR><TD ALIGN="CENTER">Jul 7, 2008</TD><TD ALIGN="CENTER">KR</TD><TD ALIGN="CENTER">10-2008-0065597</TD></TR>
<TR><TD ALIGN="CENTER">Apr 9, 2009</TD><TD ALIGN="CENTER">KR</TD><TD ALIGN="CENTER">10-2009-0030953</TD></TR>
</TABLE>

<HR>
<CENTER><B><I>Claims</B></I></CENTER>
<HR>
<BR><BR>1. A method of authenticating an RFID (radio frequency identification) tag
     having a master key by an RFID reader, comprising:requesting the RFID tag
     to transmit a security parameter and receiving a security parameter
     response from the RFID tag, wherein the RFID tag generates a session key
     based on the master key and a first random number,;transmitting a
     challenge to the RFID tag and receiving a challenge-response from the
     RFID tag; andrequesting the RFID tag to transmit authentication data and
     receiving an authentication data response from the RFID tag.
<BR><BR>2. The method of claim 1, before requesting the RFID tag to transmit the
     security parameter, further comprising:transmitting a query message to
     the RFID tag and receiving the first random number from the RFID tag;
     andsending an ACK (acknowledgement) message comprising the first random
     number to the RFID tag and receiving tag information comprising a UII
     (unique item identification), a PC (protocol control), and a XPC
     (extended protocol control) from the RFID tag.
<BR><BR>3. The method of claim 1, wherein the challenge comprises a plaintext type
     challenge random number, and the challenge-response comprises the
     plaintext type challenge random number and a second random number, which
     are encrypted using the session key.
<BR><BR>4. The method of claim 1, wherein the request for the authentication data
     comprises the second random number, and the authentication data response
     comprises authentication data, wherein the second random number is
     comprised in the challenge-response and encrypted using the session key,
     wherein the authentication data response is obtained by encrypting a
     result of an XOR (exclusive OR) operation performed on the challenge
     random number and the second random number, which are comprised in the
     challenge, by using the session key.
<BR><BR>5. The method of claim 1, further comprising requesting an authentication
     server to verify the authentication data and receiving a verified
     response from the authentication server, wherein the authentication
     server comprises information about the master key of the RFID tag.
<BR><BR>6. The method of claim 5, wherein the authentication server determines
     whether the RFID tag has been successfully authenticated based on whether
     authentication data generated by the authentication server based on the
     information about the masker key of the RFID tag is equal to
     authentication data generated by the RFID tag.
<BR><BR>7. The method of claim 5, wherein the request for verifying the
     authentication data comprises the UII of the RFID tag, the first random
     number, the security parameter, the challenge random number and the
     second random number which are encrypted using the session key and
     comprised in the challenge, and the authentication data.
<BR><BR>8. A method of authenticating in RFID environment, wherein a RFID tag
     having a master key is authenticated by an RFID reader, the method
     comprising:generating a session key based on the master key and a first
     random number;receiving a security parameter request from the RFID reader
     and transmitting a security parameter to the RFID reader;receiving a
     challenge from the RFID reader and transmitting a challenge-response to
     the RFID reader; andreceiving an authentication data request from the
     RFID reader and generating authentication data.
<BR><BR>9. The method of claim 8, before receiving the security parameter request
     from the RFID reader, further comprising:receiving a query message from
     the RFID reader and transmitting the first random number to the RFID
     reader; andreceiving an ACK message comprising the first random number
     from the RFID and transmitting tag information including a UII, a PC, and
     a XPC to the RFID reader.
<BR><BR>10. The method of claim 8, wherein the challenge comprises a plaintext
     type challenge random number, and the challenge-response comprises the
     plaintext type challenge random number and a second random number, which
     are encrypted using the session key.
<BR><BR>11. The method of claim 8, wherein the authentication data request
     comprises the second random number which is comprised in the
     challenge-response and encrypted using the session key, and the
     authentication data response comprises authentication data which is
     obtained by encrypting a result of an XOR operation performed on the
     plaintext type challenge random number of the challenge and the second
     random number by using the session key.
<BR><BR>12. The method of claim 8, wherein the authentication server determines
     whether the RFID tag has been successfully authenticated based on whether
     authentication data generated by the authentication server based on the
     information about the master key of the RFID tag is equal to
     authentication data generated by the RFID tag.
<BR><BR>13. A method by which an authentication server comprising information
     about a master key of an RFID tag supports an RFID reader to authenticate
     the RFID tag having the master key, comprisingreceiving at the
     authentication server a request to verify authentication data from the
     RFID reader, wherein said authentication data is generated by the RFID
     tag,;generating authentication data based on the information about the
     master key; anddetermining whether the RFID tag has been successfully
     authenticated based on whether authentication data generated by the
     authentication server is equal to authentication data generated by the
     RFID tag.
<BR><BR>14. The method of claim 13, wherein the request comprises a UII of the
     RFID tag, a first random number used by the RFID tag to generate a
     session key, a security parameter of the RFID tag, an encrypted challenge
     random number and an encrypted second random number which are comprised
     in a challenge-response generated by the RFID tag, and the authentication
     data.
<BR><BR>15. The method of claim 14, wherein the generation of the authentication
     data at the authentication server comprises:searching for the master key
     related to the UII and generating the session key based on the searched
     master key and the first random number;decrypting the encrypted challenge
     number and the encrypted second random number using the session key;
     andencrypting a result of an XOR operation, which is performed on the
     decrypted challenge random number and the decrypted second random number,
     by using the session key.
<BR><BR>16. An RFID reader authenticating an RFID tag having a master key,
     comprising:a security parameter obtainer which requests the RFID tag to
     transmit a security parameter and receives a security parameter response,
     wherein the RFID tag generates a session key based on the master key and
     a first random number,;a challenge processor which transmits a challenge
     to the RFID tag and receives a challenge-response; andan authenticator
     which requests the RFID tag to transmit authentication data and receives
     an authentication data response.
<BR><BR>17. The RFID reader of claim 16, further comprising a tag identifier which
     receives the first random number as a response to a query message
     transmitted to the RFID tag and receives a response comprising a UII, a
     PC, and an XPC with respect to an ACK (acknowledgement) message that the
     RFID reader has received along with the first random number, from the
     RFID tag.
<BR><BR>18. The RFID reader of claim 16, wherein the challenge comprises a
     plaintext type challenge random number, and the challenge-response
     comprises the plaintext type challenge random number and a second random
     number, which are encrypted using the session key.
<BR><BR>19. The RFID reader of claim 16, wherein the request for authentication
     data comprises the second random number which is comprised in the
     challenge-response and encrypted using the session key, and the
     authentication data response comprises authentication data which is
     obtained by encrypting a result of an XOR operation performed on the
     plaintext type challenge random number of the challenge and the second
     random number, using the session key.
<BR><BR>20. The RFID reader of claim 16, wherein the authenticator requests an
     authentication server comprising information about the master key of the
     RFID tag to verify authentication data and receives a verified response
     from the authentication server.
<BR><BR>21. An RFID tag having a master key, comprising:a key generator which
     generates a session key based on the master key and a first random
     number;a security parameter provider which generates a security parameter
     in response to a security parameter request received from the RFID
     reader;a challenge processor which generates a challenge-response to a
     challenge received from the RFID reader; andan authentication data
     provider which provides authentication data in response to an
     authentication data request received from the RFID reader.
<BR><BR>22. The RFID tag of claim 21, further comprising a tag information
     provider which generates a response comprising the first random number
     with respect to a query message received from the RFID reader and
     provides the RFID reader with a response comprising a UII, a PC, and an
     XPC with respect to an ACK message that the RFID reader has received
     along with the first random number.
<BR><BR>23. The RFID tag of claim 21, wherein the challenge-response comprises a
     challenge random number included in the challenge and a second random
     number which are encrypted using the session key, and the authentication
     data response comprises a result obtained by performing XOR operation on
     the challenge random number and the second random number, wherein the XOR
     operation is encrypted using the session key.
<BR><BR>24. An authentication server supporting an RFID reader to authenticate an
     RFID tag having a master key, comprising:an operator which receives a
     request for verifying authentication data generated by the RFID tag from
     the RFID reader and generates authentication data based on pre-stored
     information about the master key of the RFID tag; andan authenticator
     which determines whether the RFID tag has been successfully authenticated
     based on whether the authentication data is equal to authentication data
     generated by the RFID tag.
<BR><BR>25. The authentication server of claim 24, wherein the request comprises a
     UII of the RFID tag, a first random number used by the RFID tag to
     generate a session key, a security parameter of the RFID tag, an
     encrypted challenge random number and an encrypted second random number
     which are comprised in a challenge-response generated by the RFID tag,
     and the authentication data.
<BR><BR>26. The authentication server of claim 25, wherein the operator
     comprises:a key generator which generates a session key based on the
     master key searched based on the UII and the first random number; andan
     encryptor/decryptor which decrypts the encrypted challenge random number
     and the encrypted second random number and encrypts a result of an XOR
     operation performed on the decrypted challenge random number and the
     decrypted second random number.
<HR>
<CENTER><B><I>Description</B></I></CENTER>
<HR>
<BR><BR>CROSS-REFERENCE TO RELATED PATENT APPLICATION
<BR><BR>[0001]This application claims the benefit of Korean Patent Application
     Nos. 10-2008-0065597, filed on Jul. 7, 2008 and 10-2009-0030953, filed on
     Apr. 9, 2009, in the Korean Intellectual Property Office, the disclosure
     of which is incorporated herein in its entirety by reference.
<BR><BR>BACKGROUND OF THE INVENTION
<BR><BR>[0002]1. Field of the Invention
<BR><BR>[0003]The present invention relates to a method and a system by which a
     radio frequency identification (RFID) reader authenticates a passive RFID
     tag.
<BR><BR>[0004]2. Description of the Related Art
<BR><BR>[0005]Since a passive radio frequency identification (RFID) tag does not
     have a power source, the passive RFID tag obtains power from an RFID
     reader. Thus, the passive RFID tag has been simply used to recognize an
     identification (ID). Operations used in International Organization for
     Standardization (ISO)/International Electrotechnical Commission (IEC)
     18000-6 Type C that is a representative international standard of the
     passive RFID tag include generating random numbers and performing
     exclusive OR (XOR) operations. Thus, it is difficult to apply an
     additional security mechanism.
<BR><BR>[0006]If cryptographic modules appropriate for passive RFID tags are
     developed with the development of semiconductor design technology,
     various security protocols using the cryptographic modules can be
     realized. In terms of a security service, a protocol is required to
     provide an interactive authentication service, a tag authentication
     service, a reader authentication service, a key interchange service, and
     a data encryption service, and the like between a passive RFID reader and
     a passive RFID tag.
<BR><BR>[0007]Different security requirements can be respectively necessary for
     several applications, but tag authentication is required in an
     authentication service to authenticate an RFID tag.
<BR><BR>[0008]According to one general tag authentication method, an RFID reader
     obtains a master key to perform a process of authenticating an RFID tag.
     However, if the RFID reader would be a wicked insider, the RFID reader
     would get knowledge about the master key of the RFID tag. Thus, the RFID
     reader can reproduce information about the RFID tag and record the
     reproduced information in another RFID tag. Accordingly, there is
     required a method of disallowing an RFID reader to know about a master
     key and allowing the RFID reader to receive only a tag authentication
     result from an authentication server so that the RFID reader does not
     attack as a wicked insider.
<BR><BR>SUMMARY OF THE INVENTION
<BR><BR>[0009]The present invention provides an <B><I>authentication protocol</I></B>
     appropriate for a passive radio frequency identification (RFID) tag and a
     passive RFID reader.
<BR><BR>[0010]Other objects and advantages of the present invention will be
     understood in the description which follows and will be apparent from
     embodiments of the present invention. Also, it will be easily understood
     that the other objects and advantages of the present invention will be
     realized by means and combinations of the means as defined by the
     following claims.
<BR><BR>[0011]The present invention provides a method and a system, by which an
     RFID reader that does not know about a master key authenticates an RFID
     tag through an authentication server which shares the master key with the
     RFID tag.
<BR><BR>[0012]According to an aspect of the present invention, there is provided a
     method of authenticating an RFID (radio frequency identification) tag
     having a master key by an RFID reader, including: requesting the RFID tag
     to transmit a security parameter and receiving a security parameter
     response from the RFID tag, wherein the RFID generates a session key
     based on the master key and a first random number; transmitting a
     challenge to the RFID tag and receiving a challenge-response from the
     RFID tag; and requesting the RFID tag to transmit authentication data and
     receiving an authentication data response from the RFID tag.
<BR><BR>[0013]According to another aspect of the present invention, there is
     provided a method of authenticating in RFID environment, wherein a RFID
     tag having a master key is authenticated by an RFID reader, the method
     including: generating a session key based on the master key and a first
     random number; receiving a security parameter request from the RFID
     reader and transmitting a security parameter to the RFID reader;
     receiving a challenge from the RFID reader and transmitting a
     challenge-response to the RFID reader; and receiving an authentication
     data request from the RFID reader and generating authentication data.
<BR><BR>[0014]According to another aspect of the present invention, there is
     provided a method by which an authentication server including information
     about a master key of an RFID tag supports an RFID reader to authenticate
     the RFID tag having the master key, including: receiving at the
     authentication server a request to verify authentication data from the
     RFID reader, wherein the authentication data is generated by the RFID
     tag; generating authentication data based on the information about the
     master; and determining whether the RFID tag has been successfully
     authenticated based on whether authentication data generated by the
     authentication server is equal to authentication data generated by the
     RFID tag.
<BR><BR>[0015]According to another aspect of the present invention, there is
     provided an RFID reader authenticating an RFID tag having a master key,
     including: a security parameter obtainer which requests the RFID tag to
     transmit a security parameter and receives a security parameter response,
     wherein the RFID tag generates a session key based on the master key and
     a first random number; a challenge processor which transmits a challenge
     to the RFID tag and receives a challenge-response ; and an authenticator
     which requests the RFID tag to transmit authentication data and receives
     an authentication data response.
<BR><BR>[0016]According to another aspect of the present invention, there is
     provided an RFID tag having a master key, including: a key generator
     which generates a session key based on the master key and a first random
     number; a security parameter provider which generates a security
     parameter in response to a security parameter request received from the
     RFID reader; a challenge processor which generates a challenge-response
     to a challenge received from the RFID reader; and an authentication data
     provider which provides authentication data in response to an
     authentication data request received from the RFID reader.
<BR><BR>[0017]According to another aspect of the present invention, there is
     provided an authentication server supporting an RFID reader to
     authenticate an RFID tag having a master key, including: an operator
     which receives a request for verifying authentication data generated by
     the RFID tag from the RFID reader and generates authentication data based
     on pre-stored information about the master key of the RFID tag; and an
     authenticator which determines whether the RFID tag has been successfully
     authenticated based on whether the authentication data is equal to
     authentication data generated by the RFID tag.
<BR><BR>BRIEF DESCRIPTION OF THE DRAWINGS
<BR><BR>[0018]The above and other features and advantages of the present invention
     will become more apparent by describing in detail exemplary embodiments
     thereof with reference to the attached drawings in which:
<BR><BR>[0019]FIG. 1 illustrates a method of authenticating a radio frequency
     identification (RFID) tag according to an embodiment of the present
     invention;
<BR><BR>[0020]FIGS. 2A and 2B respectively illustrate a command and a reply
     "Get_SecParam" according to an embodiment of the present invention;
<BR><BR>[0021]FIGS. 3A and 3B respectively illustrate a command "Sec_ReqRN" and a
     reply "Sec_ReqRN" according to an embodiment of the present invention;
<BR><BR>[0022]FIGS. 4A and 4B respectively illustrate a command "Req_Auth" and a
     reply "Req_Auth" according to an embodiment of the present invention;
<BR><BR>[0023]FIG. 5 is a schematic flowchart of a method by which an RFID reader
     authenticates an RFID tag, according to an embodiment of the present
     invention;
<BR><BR>[0024]FIG. 6 is a schematic flowchart of a method by which an RFID tag is
     authenticated by an RFID reader, according to another embodiment of the
     present invention;
<BR><BR>[0025]FIG. 7 is a schematic flowchart of a method by which an
     authentication server including information about a master key of an RFID
     tag supports an RFID reader to authenticate the RFID tag having the
     master key, according to an embodiment of the present invention; and
<BR><BR>[0026]FIG. 8 is a schematic block diagram of entities of an RFID system by
     which an RFID reader authenticates an RFID tag by using an authentication
     server, according to an embodiment of the present invention.
<BR><BR>DETAILED DESCRIPTION OF THE INVENTION
<BR><BR>[0027]The present invention will now be described more fully with
     reference to the accompanying drawings, in which exemplary embodiments of
     the invention are shown. Like reference numerals in the drawings denote
     like elements. Detailed descriptions of known functions or structures
     related to the description of the present invention which follows will be
     omitted if they unnecessarily obscure the concept of the invention.
<BR><BR>[0028]Also, when any part "includes" any element, this means that the any
     part may further include another element not except the other element if
     a particular opposite statement is not made. Terms " . . . unit," " . . .
     device," "module," "block," or the like described in the specification
     means a unit which processes at least one function or operation; the unit
     may be realized as hardware, software, or a combination of hardware and
     software.
<BR><BR>[0029]The present invention provides a protocol for authenticating a
     passive radio frequency identification (RFID) tag. The protocol used in
     the present invention is compatible with International Organization for
     Standardization (ISO)/International Electrotechnical Commission (IEC)
     18000-6 Type C which is a representative international standard of a
     passive RFID tag.
<BR><BR>[0030]The present invention also provides various security services, i.e.,
     tag authentication technology for authenticating an RFID tag, in
     particular, a protocol through which an RFID reader knows about only a
     tag authentication result not about a master key of the RFID tag.
<BR><BR>[0031]In the present invention, when the RFID tag has the master key, and
     the RIFD reader does not have a master key, the RFID reader receives an
     authentication message from the RFID tag and transmits the authentication
     message to an authentication server. Thus, the authentication server
     verifies authentication data of the RFID tag using the master key and
     informs the RFID reader of the verification result. Therefore, the
     verification result can be used to prevent an unauthorized reproduction
     of tag information performed by the RFID reader and an authentication
     service for authenticating a product to which a passive RFID tag is
     attached.
<BR><BR>[0032]FIG. 1 illustrates a method of authenticating an RFID tag according
     to an embodiment of the present invention. In the present embodiment, an
     RFID reader communicates with an authentication server through a stable
     channel. Also, the RFID tag has a security parameter "SecParam." The
     security parameter "SecParam" refers to a structure which includes
     information related to a cryptographic algorithm which is to be used.
     However, a detailed description of the security parameter "SecParam" will
     not be given.
<BR><BR>[0033]In the present embodiment, the RFID tag stores a master key, the
     RFID reader does know about the master key of the RFID tag, and only the
     authentication server includes information about the master key of the
     RFID tag. The master key is used by the RFID tag only to authenticate the
     RFID tag.
<BR><BR>[0034]In operation 0, a security tag having a security parameter
     "SecParam," i.e., the RFID tag, generates a random number "RN16" of 16
     bits and generates a session key using the random number "RN16" and the
     master key. Various algorithms may be used to generate the session key.
     In the present embodiment, an advanced encryption standard (AES) module
     may be used to perform AES encryption by using encryption
     algorithm-related information included in the security parameter
     "SecParam" so as to generate the session key.
<BR><BR>[0035]Operations 1 through 4 are equal to inventory processes which comply
     with ISO/IEC 18000-6 Type C. In more detail, in operation 1, the RFID
     reader transmits a query message to the RFID tag. "Query,"
     "Query_Adjust," and "Query_Rep" are commands defined in ISO/IEC 18000-6
     Type C, and thus their detailed descriptions will be omitted. In
     operation 2, the RFID tag receives the query message and transmits the
     random number "RN16" to the RFID reader. In operation 3, the RFID reader
     receives the random number "RN16" and transmits an ACK message to the
     RFID tag. The ACK message refers to a command through which the RFID
     reader requests the RFID tag to transmit a unique item identification
     (UII). In operation 4, the RFID tag receives the ACK message from the
     RFID reader and transmits a protocol control (PC), an eXtended protocol
     control (XPC), and the UII. The RFID tag transmits its UII as plaintext.
<BR><BR>[0036]In operation 5, the RFID reader, which is to authenticate the RFID
     tag according to a <B><I>security protocol,</I></B> transmits a command "Get_SecParam"
     to the RFID tag. Here, the RFID reader does not have the master key and
     thus cannot generate a session key. Thus, the RFID reader transmits the
     command "Get_SecParam" as plaintext.
<BR><BR>[0037]In operation 6, the RFID tag receives the command "Get_SecParam" and
     transmits the security parameter "SecParam" to the RFID reader.
<BR><BR>[0038]FIG. 2A illustrates a command "Get_SecParam," and FIG. 2B
     illustrates a reply "Get_Secparam." "0xE101 (11100001 00000001.sub.2)"
     may be used as an example of a code value of the command "Get_Secparam."
     The command "Get_Secparam" includes a random number as a handle, and the
     reply "Get_Secparam" includes a header, the security parameter
     "SecParam", and the random number as the handle. The command and reply
     "Get_SecParam" are transmitted as plaintexts. Here, "CRC-16" of both of
     the command and replay "Get_SecParam" is not encrypted.
<BR><BR>[0039]In operation 7, the RFID reader generates a random number "Ch16"
     which is to be used as a challenge and transmits the random number "Ch16"
     included in a message "Sec_ReqRN" to the RFID tag. The message
     "Sec_ReqRN" includes the random number "Ch16" to be used as the challenge
     and the random number "RN16" received in operation 2 as parameters. The
     message "Sec_ReqRN" has the random number "RN16" as the parameter and
     refers to a tag address concept or a session ID concept. In other words,
     although a plurality of RFID tags receive the message "Sec_ReqRN," only
     the RFID tag, which has transmitted the random number "RN16" in operation
     2, recognizes the message "Sec_ReqRN" as a message which has been
     transmitted thereto. A random number used for this purpose is referred to
     as a handle in ISO/IEC 18000-6 Type C. Since the RFID reader does not
     know about the master key, the message "Sec_ReqRN" is transmitted as
     plaintext.
<BR><BR>[0040]In operation 8, the RFID tag receives the challenge from the RFID
     reader, encrypts the random number "Ch16" and a new random number
     "newRN16," and transmits the encrypted random numbers "Ch16" and
     "newRN16" to the RFID tag.
<BR><BR>[0041]FIG. 3A illustrates a command "Sec_ReqRN," and FIG. 3B illustrates a
     reply "Sec_ReqRN." The command "Sec_ReqRN" changes a state of the RFID
     tag to an open status like a command "Req_RN" defined in ISO/IEC 18000-6
     Type C. The command and reply "Sec_ReqRN" refers to operations of
     transmitting and receiving a challenge and/or response for authenticating
     the RFID tag. "0xE102" is used an example of a code of the command
     "Sec_ReqRN," and the command "Sec_ReqRN" includes a value of a challenge
     and a value of a random number as a handle and is transmitted as
     plaintext. The reply "Sec_ReqRN" includes an encrypted value of the
     challenge and an encrypted value of a new random number. In the command
     "Sec_ReqRN," the challenge has a nonce value of 16 bits which are
     randomly generated by the RFID reader, and a response of the RFID tag has
     an encrypted value of the challenge received from the RFID reader.
     "CRC-16" of both the command and the reply "Sec-ReqRN" is not encrypted.
<BR><BR>[0042]In operation 9, the RFID reader transmits a message "Req_Auth" to
     the RFID tag to obtain authentication data "Auth_data." Here, the
     encrypted new random number "newRN16" received as the handle in operation
     8 is used as it is.
<BR><BR>[0043]In operation 10, the RFID tag transmits the authentication data
     "Auth_data" to the RFID reader. The RFID tag performs an exclusive OR
     (XOR) operation on the random number "Ch16" and the new random number
     "newRN16," encrypts the resultant value of the XOR operation, generates
     the authentication data "Auth_data," and transmits the authentication
     data "Auth_data" to the RFID reader.
<BR><BR>[0044]FIG. 4A illustrates a command "Req_Auth," and FIG. 4B illustrates a
     reply "Req_Auth." The command "Req_Auth" is to request authentication
     data for authenticating the RFID tag. For example, a code of the command
     "Req_Auth" is "0xE103," and the RFID reader transmits the command
     "Req_Auth" as a plaintext, and the RFID tag encrypts the authentication
     data "Auth_data" and transmits the encrypted authentication data
     "Auth_data" to the RFID reader. In other words, according to a tag
     <B><I>authentication protocol</I></B> since the RFID reader does not have the master
     key, a command of the RFID reader may not be encrypted, but the RFID tag
     may generate a session key and perform an encryption operation using the
     master key thereof. The encrypted authentication data "Auth_data"
     transmitted from the RFID tag is transmitted to and decrypted by the
     authentication server. Here, "CRC-16" of both of the command and reply
     "Req-Auth" is not encrypted.
<BR><BR>[0045]In operation 11, the RFID reader ends the communication with the
     RFID tag and communicates with the authentication server to verify values
     transmitted from the RFID tag. In other words, the RFID reader transmits
     a message "Req_Verify," including the UII of the RFID tag, the random
     number "RN16," the security parameter "SecParam," the encrypted random
     number "Ch16" and new random number "newRN16" received in operation 8,
     and the authentication data "Auth_data" received in operation 10, to the
     authentication server. Here, the communication between the RFID reader
     and the authentication server may be performed through a stable channel.
<BR><BR>[0046]In operation 12, the authentication server verifies the
     authentication data "Auth_data" received from the RFID reader and
     transmits a result of whether the RFID tag has been successfully
     authenticated, to the RFID reader. The authentication server searches for
     a master key "K" related to the UII of the RFID tag and induces a session
     key from the random number "RN16" and the master key "K." The
     authentication server decrypts the encrypted random number "Ch16" and new
     random number "newRN16" by using the session key to search for the random
     number "RN16" and the new random number "newRN16." The authentication
     server performs an XOR operation on the random number "Ch16" and the new
     random number "newRN16" and encrypts the result of the XOR operation to
     obtain authentication data "Auth-data." If the authentication data
     "Auth_data" obtained by the authentication server is equal to the
     authentication data "Auth_data" received from the RFID reader, the
     authentication server determines that the RFID tag has been successfully
     authenticated. If not, the authentication server determines that the RFID
     tag has not been successfully authenticated. The authentication server
     transmits the determination result to the RFID reader. The determination
     result of the authentication of the RFID tag includes an authentication
     success "Yes," or an authentication failure "No," and the UII.
<BR><BR>[0047]FIG. 5 is a schematic flowchart of a method by which an RFID reader
     authenticates an RFID tag, according to an embodiment of the present
     invention. The RFID tag is a security tag including a security parameter
     and has a master key. The RFID reader does not have information about the
     master key of the RFID tag, and an authentication server has the
     information about the master key of the RFID tag.
<BR><BR>[0048]In operation S501, the RFID reader performs an inventory round with
     the RFID tag, which has generated a session key based on the master key
     and a first random number, to identify the RFID tag. The RFID reader
     transmits a query message to the RFID tag to start the inventory round
     and receives the first random number from the RFID tag. The RFID reader
     receives the first random number as an acknowledgement (ACK) message and
     receives tag information from the RFID tag. The tag information includes
     a UII, a PC, and an XPC.
<BR><BR>[0049]In operation S502, the RFID reader requests the RFID tag to transmit
     the security parameter and receives a security parameter response from
     the RFID tag. The security parameter response includes the security
     parameter as plaintext.
<BR><BR>[0050]In operation S503, the RFID reader transmits a challenge to the RFID
     tag and receives a challenge-response from the RFID tag. The challenge
     transmitted from the RFID reader includes plaintext challenge number and
     the first random number as a handle, and the challenge-response
     transmitted from the RFID tag includes a challenge random number and a
     second random number which are encrypted using a session key.
<BR><BR>[0051]In operation S504, the RFID reader requests the RFID tag to transmit
     authentication data and receives an authentication data response from the
     RFID tag. The request of the RFID reader for the authentication data
     includes the second random number of the challenge-response encrypted by
     the session key as a handle, and the authentication data response
     includes authentication data which is obtained by encrypting a result of
     an XOR operation performed on the challenge number of the challenge and
     the second random number by using the session key.
<BR><BR>[0052]In operation S505, the RFID reader requests the authentication
     server to verify the authentication data. In operation S506, the RFID
     reader receives a result of authenticating the RFID tag from the
     authentication server. The request for verifying the authentication data
     includes the UII, the first random number, the security parameter, the
     encrypted challenge random number, the encrypted second random number,
     and the authentication data. The authentication server determines whether
     authentication data generated based on pre-stored information about the
     master key of the RFID tag is equal to the authentication data which is
     generated by the RFID tag and received from the RFID reader, to determine
     whether the RFID tag has been successfully authenticated.
<BR><BR>[0053]FIG. 6 is a schematic flowchart of a method by which an RFID tag is
     authenticated by an RFID reader, according to another embodiment of the
     present invention. The RFID tag is a security tag including a security
     parameter and has a master key. The RFID reader does not have information
     about the master key of the RFID tag, and an authentication server has
     the information about the master key of the RFID tag.
<BR><BR>[0054]In operation S601, the RFID tag generates a session key based on the
     master key and a first random number. The RFID tag generates a random
     number and generates the session key by using the master key and the
     generated random number.
<BR><BR>[0055]In operation S602, the RFID tag performs an inventory round with the
     RFID reader to transmit tag identification information to the RFID
     reader. The RFID tag receives a query message from the RFID reader to
     start the inventory round and transmits the first random number to the
     RFID reader. The RFID tag receives an ACK message that the RFID reader
     has received the first random number, from the RFID reader and transmits
     tag information to the RFID reader. The tag information includes a UII, a
     PC, and an XPC.
<BR><BR>[0056]In operation S603, the RFID tag receives a request for the security
     parameter and transmits the security parameter to the RFID reader.
<BR><BR>[0057]In operation S604, the RFID tag receives a challenge from the RFID
     reader and transmits a challenge-response to the RFID reader. The RFID
     tag receives the challenge including a plaintext challenge random number
     from the RFID reader and transmits the challenge response, including the
     plaintext challenge random number and a second random number, which are
     encrypted using the session key, to the RFID reader.
<BR><BR>[0058]In operation S605, the RFID tag receives a request for
     authentication data from the RFID reader, generates the authentication
     data, and transmits the authentication data to the RFID reader. The RFID
     tag transmits an authentication data response to the request including
     the encrypted second random number. The authentication data response
     includes authentication data which is obtained by encrypting a result of
     an XOR operation performed on the challenge random number and the second
     random number by using the session key.
<BR><BR>[0059]FIG. 7 is a schematic flowchart of a method by which an
     authentication server including information about a master key of an RFID
     tag supports an RFID reader to authenticate the RFID tag having the
     master key, according to an embodiment of the present invention. The RFID
     tag is a security tag including a security parameter and has a master
     key. The RFID reader does not have information about the master key of
     the RFID tag, but the authentication server has the information about the
     master key of the RFID tag.
<BR><BR>[0060]In operation S701, the authentication server receives a request for
     verifying authentication data from the RFID reader. The request includes
     a UII of the RFID tag, a first random number which is used by the RFID
     tag to generate a session key, the security parameter of the RFID tag, an
     encrypted challenge random number included in a challenge-response which
     is generated by the RFID tag, an encrypted second random number, and the
     authentication data.
<BR><BR>[0061]In operation S702, the authentication server generates its
     authentication data based on pre-stored information about the master key
     of the RFID tag. The authentication server searches for a master key
     related to the UII and generates the session key based on the searched
     master key and the first random number. The authentication server
     decrypts the encrypted challenge random number and the encrypted second
     random number by using the generated session key and encrypts a result of
     an XOR operation performed on the decrypted challenge random number and
     the decrypted second random number.
<BR><BR>[0062]In operation S703, the authentication server determines whether its
     authentication data is equal to authentication data generated by the RFID
     tag to determine whether the RFID tag has been successfully
     authenticated. If the authentication data generated by the authentication
     server is equal to the authentication data generated by the RFID tag, the
     authentication server determines that the RFID tag has been successfully
     authenticated. If not, the authentication server determines that the RFID
     tag has not been successfully authenticated. The authentication server
     transmits the determination result to the RFID reader.
<BR><BR>[0063]FIG. 8 is a schematic block diagram of entities of an RFID system by
     which an RFID reader authenticates an RFID tag by using an authentication
     server, according to an embodiment of the present invention.
<BR><BR>[0064]Hereinafter, detailed descriptions of contents overlapping with the
     above descriptions will be omitted.
<BR><BR>[0065]Referring to FIG. 8, the RFID system may be an RFID system having a
     900 MHz-band wireless interface which is defined in ISO/IEC 18000-6 Type
     C and includes an RFID reader 100, an RFID tag 200, and an authentication
     server 300.
<BR><BR>[0066]The RFID reader 100 communicates with the RFID tag 200 to check an
     authenticity of the RFID tag 200. The RFID reader 100 may communicate
     with an RFID tag having a security function and an RFID tag not having a
     security function. The RFID reader 100 does not have a master key and
     thus does not directly authenticate the RFID tag 200 but authenticates
     the RFID tag 200 by using the authentication server 300. The RFID reader
     100 may be a reader in a store, a portable reader (e.g., a reader
     installed in a cellular phone) of a consumer, or the like. The RFID
     reader 100 includes a reader controller 101 and a memory 109. The reader
     controller 101 includes a basic protocol and a <B><I>security protocol</I></B>
     according to the present invention and executes a protocol depending on a
     type of an RFID tag. The basic protocol is used to communicate with an
     RFID tag not having a security function, e.g., the basic protocol may be
     a protocol which complies with ISO/IEC 18000-6 Type C. The reader
     controller 101 includes a tag identifier 102, a security parameter
     obtainer 103, a challenge processor 104, and an authenticator 105.
<BR><BR>[0067]The tag identifier 102 performs an inventory round with the RFID tag
     200 to identify the RFID tag 200. The tag identifier 102 generates a
     query message, transmits the query message to the RFID tag 200, and
     receives a first random number as a response from the RFID tag 200. The
     tag identifier 102 generates an ACK message that the RFID reader 100 has
     received the first random number, transmits the ACK message to the RFID
     tag 200, and receives a response including a UII, a PC, and an XPC from
     the RFID tag 200. The security parameter obtainer 103 generates a request
     for the security parameter, and transmits the request to the RFID tag
     200, and receives a security parameter response from the RFID tag to
     obtain the security parameter. The challenge processor 104 generates a
     challenge, transmits the challenge to the RFID tag 200, and receives a
     challenge-response from the RFID tag 200. The challenge processor 104
     generates a challenge random number of 16 bits and transmits the
     challenge including the challenge random number to the RFID tag 200. The
     authenticator 105 generates an authentication data request, transmits the
     authentication data request to the RFID tag 200, and receives an
     authentication data response from the RFID tag 200 to obtain
     authentication data. The authenticator 105 generates an authentication
     data verifying request, transmits the authentication data verifying
     request to the RFID tag 200, and receives a verified response from the
     RFID tag 200 to perform an authentication with respect to the RFID tag
     200. The memory 109 stores a program for controlling an operation of the
     RFID reader 100, data generated by the RFID reader 100, and data received
     from the RFID tag 200. For example, the memory 109 may be one of various
     types of volatile memory which temporarily stores data while power is
     supplied.
<BR><BR>[0068]The RFID tag 200 is a security tag which is compatible with an
     existing standard passive RFID tag, includes a security parameter to have
     an enhanced security function, and shares the master key with the
     authentication server 300. The RFID tag 200 includes a tag controller 201
     and a memory 209. The tag controller 201 includes a key generator 202, a
     tag information provider 203, a security parameter provider 204, a
     challenge processor 205, and an authentication data provider 206.
<BR><BR>[0069]The key generator 202 generates a session key based on the master
     key and the first random number generated by a random number generator
     (not shown). The tag information provider 203 generates a response,
     including the first random number of 16 bits, with respect to the query
     message received from the RFID reader 100, generates a response,
     including a UII, a PC, and an XPC, with respect to the ACK message that
     the RFID reader 100 has received along with the first random number,
     wherein the ACK message is received from the RFID reader 100, and
     transmits the responses to the RFID reader 100. The security parameter
     provider 204 generates a security parameter response, including the
     security parameter, with respect to the security parameter request
     received from the RFID reader 100 and transmits the security parameter
     response to the RFID reader 100. The challenge processor 205 transmits a
     challenge-response, including a second random number of 16 bits and a
     challenge random number which have been encrypted, with respect to the
     challenge received from the RFID reader 100, to the RFID reader 100. The
     authentication data provider 206 generates authentication data in
     response to the authentication data request received from the RFID reader
     100 and transmits an authentication data response including
     authentication data to the RFID reader 100.
<BR><BR>[0070]The authentication server 300 communicates with the RFID reader 100
     through a predetermined channel, which may be regarded as a kind of web
     server access. The authentication server 300 shares the master key with
     the RFID tag 200. The authentication server 300 includes an operator 301,
     an authenticator 305, and a database (DB) 309.
<BR><BR>[0071]The operator 301 receives the request for verifying the
     authentication data generated by the RFID tag 200 from the RFID reader
     100 and generates its own authentication data based on pre-stored
     information about the master key of the RFID tag 200. The operator 301
     receives the UII, the first random number used by the RFID tag 200 to
     generate the session key, the security parameter of the RFID tag 200, the
     encrypted challenge random number included in the challenge-response of
     the RFID tag 200, the encrypted second random number, and the
     authentication data generated by the RFID tag 200, from the RFID reader
     100. The operator 301 includes a key generator 302 and an
     encryptor/decryptor 303. The key generator 302 searches the DB 309 for a
     master key corresponding to the UII of the RFID tag 200 and generates a
     session key based on the searched master key and the first random number.
     The encryptor/decryptor 303 decrypts the encrypted challenge random
     number and the encrypted second random number and encrypts a result of an
     XOR operation performed on the decrypted challenge random number and the
     decrypted second random number. The authenticator 305 determines whether
     the authentication data generated by the operator 301 is equal to the
     authentication data generated by the RFID tag 200. If the authentication
     data generated by the operator 301 is equal to the authentication data
     generated by the RFID tag 200, the authenticator 305 determines that the
     RFID tag 200 has been successfully authenticated. If not, the
     authenticator 305 determines that the RFID tag 200 has not been
     successfully authenticated. The authenticator 305 transmits the
     determination result to the RFID reader 200. In other words, the
     authentication server 300 transmits only the determination result to the
     RFID reader 200 based on given information.
<BR><BR>[0072]A method of authenticating an RFID tag according to the present
     invention may be applied in a store such as a meat shop. An RFID reader
     in the store stably communicates with an authentication server. However,
     if the RFID reader in the store knows about a master key of the RFID tag
     (an RFID tag attached to a beef pack in the case of the meat shop), the
     RFID reader may abuse the master key. Thus, the RFID reader in the store
     should not know about the master key to prevent this abuse. Since a
     consumer should check whether the RFID tag is a normal tag, the RFID tag
     should be authenticated by using the RFID reader in the store or by using
     a portable reader of the consumer. In other words, in the method of the
     present invention, an arbitrary RFID reader can receive a result of
     whether an RFID tag has been authenticated, from an authentication
     server.
<BR><BR>[0073]In the present invention, a UII is provided as plaintext to all RFID
     readers. In other words, the present invention may be used in an
     application which does not demand that an RFID reader should be
     authenticated. However, it may be important to consider authentication of
     an RFID tag. The RFID tag generates authentication data including a
     challenge, which is generated by and transmitted from the RFID reader,
     encrypts the authentication data, and transmits the encrypted
     authentication data to the RFID reader. Thus, if a value verified by an
     authentication server is an accurate value, it is considered that the
     RFID tag uses an accurate session key. Since the accurate session key is
     induced from an accurate master key, it is determined that the master key
     of the RFID tag is equal to a master key of the authentication server.
     Thus, the RFID tag is authenticated as a valid tag.
<BR><BR>[0074]The RFID tag generates authentication data including a challenge
     received from an RFID reader, encrypts the authentication data, and
     transmits the authentication data to the RFID reader. If an RFID reader
     of a consumer tries to authenticate the RFID tag, the RFID reader changes
     the challenge to authenticate the RFID tag. Thus, the RFID reader detects
     spoofing caused by a replay of the RFID tag.
<BR><BR>[0075]As described above, in a method and a system for authenticating an
     RFID tag, an RFID reader does not know about a master key of the RFID tag
     and receives a verification of reliability of tag information from the
     authentication server. Thus, the RFID reader cannot attack as a wicked
     insider and can check whether the RFID tag has been authenticated.
<BR><BR>[0076]An efficient protocol having a relatively simple structure is
     provided.
<BR><BR>[0077]The RFID tag is compatible with ISO/IEC 18000-6 Type C and thus does
     not affect any existing system. An infrastructure is established to
     authenticate the RFID tag.
<BR><BR>[0078]The present invention can also be embodied as computer readable
     codes on a computer readable recording medium. The computer readable
     recording medium is any data storage device that can store data which can
     be thereafter read by a computer system. Examples of the computer
     readable recording medium include read-only memory (ROM), random-access
     memory (RAM), CD-ROMs, magnetic tapes, floppy disks, and optical data
     storage devices, and carrier waves (such as data transmission through the
     Internet). The computer readable recording medium can also be distributed
     over network coupled computer systems so that the computer readable code
     is stored and executed in a distributed fashion. Also, functional
     programs, codes, and code segments for accomplishing the present
     invention can be easily construed by programmers skilled in the art to
     which the present invention pertains.
<BR><BR>[0079]While this invention has been particularly shown and described with
     reference to embodiments thereof, it will be understood by those skilled
     in the art that various changes in form and details may be made therein
     without departing from the spirit and scope of the invention as defined
     by the appended claims. The embodiments should be considered in
     descriptive sense only and not for purposes of limitation. Therefore, the
     scope of the invention is defined not by the detailed description of the
     invention but by the appended claims, and all differences within the
     scope will be construed as being included in the present invention.
<BR><BR><CENTER><B>* * * * *</B></CENTER>
<HR><CENTER>
<a href=http://aiw1.uspto.gov:80/.aiw?Docid=20100001840&homeurl=http%3A%2F%2Fappft1.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%2526r%3D9%2526p%3D1%2526f%3DG%2526l%3D50%2526d%3DPG01%2526S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%2526OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)%2526RS%3D(ABST%2F(RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522)%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))&PageNum=&Rtype=&SectionNum=&idkey=AFDA59809C2C
><img src="/netaicon1/PTO/image.gif" alt="[Image]" border="0" width="63" height="24" align="middle"></A>
</CENTER>
<center>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=US20100001840&backUrl1=http%3A//appft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%26r%3D9%26p%3D1%26f%3DG%26l%3D50%26d%3DPG01%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)&backLabel1=Back%20to%20Published%20Application%20Number%3A%2020100001840">
<img border=0 src="/netaicon1/PTO/order.gif" alt="[Order Copy]"></A>
<A HREF="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//appft1.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.html%26r%3D9%26p%3D1%26f%3DG%26l%3D50%26d%3DPG01%26S1%3D((RFID%252BOR%252B%252522radio%252Bfrequency%252Bidentification%252522).AB.%252BAND%252B(%252522Security%252Bprotocol%252522%252BOR%252B%252522Authentication%252Bprotocol%252522))%26OS%3Dabst%2F(RFID%252Bor%252B(%252522radio%252Bfrequency%252Bidentification%252522))%252BAND%252B(%252522Security%252Bprotocol%252522%252Bor%252B%252522Authentication%252Bprotocol%252522)&backLabel1=Back%20to%20Published%20Application%20Number%3A%2020100001840">
<img border=0 src="/netaicon1/PTO/cart.gif" border=0 alt="Shopping Cart"]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=9&p=1&f=S&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/hitlist.gif border=0 ALT=[CURR_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=9&p=2&f=S&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&Query=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=8&p=1&f=G&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.html&r=10&p=1&f=G&l=50&d=PG01&S1=((RFID+OR+%22radio+frequency+identification%22).AB.+AND+(%22Security+protocol%22+OR+%22Authentication+protocol%22))&OS=abst/(RFID+or+(&quot;radio+frequency+identification&quot;))+AND+(&quot;Security+protocol&quot;+or+&quot;Authentication+protocol&quot;)><IMG ALIGN=MIDDLE SRC=/netaicon1/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>
<a href="#top"><img align=middle src="/netaicon1/PTO/top.gif" border=0></a>
</center>
<a name="bottom"></a>
<center>
<A HREF="/netahtml/PTO/help/help.html"><IMG BORDER="0" WIDTH="63" HEIGHT="24" SRC="/netaicon1/PTO/help.gif" ALT="[Help]" align=middle></A>
<a href="http://www.uspto.gov/patft/index.html"><img src="/netaicon1/PTO/home.gif" alt="[Home]" border="0" width="63" height="24" align=middle></a>
<a href="/netahtml/PTO/search-bool.html"><img src="/netaicon1/PTO/boolean.gif" alt="[Boolean Search]" border="0" width="63" height="24" align=middle></a>
<A HREF="/netahtml/PTO/search-adv.html"><IMG WIDTH="63" HEIGHT="24" BORDER="0" SRC="/netaicon1/PTO/manual.gif" ALT="[Manual]" align=middle></A>
<a href="/netahtml/PTO/srchnum.html"><img src="/netaicon1/PTO/number.gif" alt="[Number Search]" border="0" width="63" height="24" align=middle></a>
<A HREF="http://www.uspto.gov/go/ptdl/">
<IMG width=63 height=24 border=0 SRC="/netaicon1/PTO/ptdl.gif" ALT="[PTDLs]" align=middle></A><!-- <IMG border=0 src=/netaicon1/PTO/titlebar.gif><br> -->
</center></BODY>
</HTML>